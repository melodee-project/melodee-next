version: "3.9"
services:
  melodee:
    image: ghcr.io/melodee-project/melodee-api:latest
    container_name: melodee
    restart: unless-stopped
    ports:
      - "8080:8080"   # API + Admin static (if embedded)
    environment:
      # Minimal home-lab defaults
      - MELODEE_STORAGE_DIR=/data
      - MELODEE_DB=sqlite:///data/melodee.db
      - MELODEE_EMBED_ADMIN=true           # serve Admin UI static build
      - MELODEE_HLS_DIR=/data/hls
      - MELODEE_ART_DIR=/data/art
      - MELODEE_AUTH_MODE=local            # local|oidc
      # If OIDC is enabled, set:
      # - OIDC_ISSUER_URL=...
      # - OIDC_CLIENT_ID=...
      # - OIDC_CLIENT_SECRET=...
    volumes:
      - melodee-data:/data
volumes:
  melodee-data:
